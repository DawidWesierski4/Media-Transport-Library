From 2fb4121c405d5f682361d5ab804c51931c2a706a Mon Sep 17 00:00:00 2001
From: qiaoliu <qiao.liu@intel.com>
Date: Tue, 28 Dec 2021 10:06:03 +0800
Subject: [PATCH 6/7] Bind each thread to dedicate core

---
 lib/eal/windows/eal.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/lib/eal/windows/eal.c b/lib/eal/windows/eal.c
index 6cae594eaf..232068fd2f 100644
--- a/lib/eal/windows/eal.c
+++ b/lib/eal/windows/eal.c
@@ -422,6 +422,10 @@ rte_eal_init(int argc, char **argv)
 		/* create a thread for each lcore */
 		if (eal_thread_create(&lcore_config[i].thread_id) != 0)
 			rte_panic("Cannot create thread\n");
+	    ret = pthread_setaffinity_np(lcore_config[i].thread_id,
+			sizeof(rte_cpuset_t), &lcore_config[i].cpuset);
+		if (ret != 0)
+			rte_panic("Cannot set affinity\n");
 	}
 
 	/* Initialize services so drivers can register services during probe. */
-- 
2.17.1

